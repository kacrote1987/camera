<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <title>万像慧治</title>
    <link rel="stylesheet" href="v3.11.2/css/ol.css" />
    <script type="text/javascript" src="v3.11.2/build/ol.js"></script>
    <link rel="stylesheet" href="../../layuiadmin/layui/css/layui.css" media="all">
    <link rel="stylesheet" href="../../layuiadmin/style/admin.css" media="all">
    <link rel="shortcut icon" type="image/x-icon" href="../img/logo.png" />
</head>
<script charset="utf-8" src="https://map.qq.com/api/gljs?libraries=tools&v=1.exp&key=OB4BZ-D4W3U-B7VVO-4PJWW-6TKDJ-WPB77"></script>
<style type="text/css">
    html,body,.main{
        margin:0px;
        padding:0px;
        width:100%;
        height:100%;
    }
    .left{
        position:absolute;
        z-index:100;
        left:0px;
        width:20%;
        height:100%;
        background:#666;
    }
    .right{
        position:absolute;
        z-index:100;
        right:0px;
        width:80%;
        height:100%;
        background:#CCC;
    }
    .flexible{
        position:absolute;
        z-index:100;
        left:20%;
        top:47%;
        cursor:pointer;
    }

    #container {
        width: 100%;
        height: 95%;
    }
    .btn {
        position: absolute;
        top: 30px;
        z-index: 1001;
        padding: 6px 8px;
    }
    .btn-left {
        left: 30px;
    }
    .btn-right {
        left: 150px;
    }
    #toolControl {
        position: absolute;
        top: 10px;
        left: 0px;
        right: 0px;
        margin: auto;
        width: 300px;
        z-index: 1001;
    }

    .toolItem {
        width: 30px;
        height: 30px;
        float: left;
        margin: 1px;
        padding: 4px;
        border-radius: 3px;
        background-size: 30px 30px;
        background-position: 4px 4px;
        background-repeat: no-repeat;
        box-shadow: 0 1px 2px 0 #e4e7ef;
        background-color: #ffffff;
        border: 1px solid #ffffff;
    }

    .toolItem:hover {
        border-color: #789cff;
    }

    .active {
        border-color: #d5dff2;
        background-color: #d5dff2;
    }

    #panel_search {
        position: absolute;
        background: #FFF;
        width:350px;
        height:700px;
        padding: 20px;
        z-index: 9999;
        top: 70px;
        left: 30px;
    }

    #panel_tag {
        position: absolute;
        background: #FFF;
        width:350px;
        height:700px;
        padding: 20px;
        z-index: 9999;
        top: 70px;
        left: 30px;
    }

    #panel_plan {
        position: absolute;
        background: #FFF;
        width:350px;
        height:700px;
        padding: 20px;
        z-index: 9999;
        top: 70px;
        left: 30px;
    }

    #panel_menu {
        position: absolute;
        background: #FFF;
        width:460px;
        height:230px;
        padding: 20px;
        z-index: 9999;
        top: 25%;
        left: 60%;
    }
    #panel_share {
        position: absolute;
        background: #FFF;
        width:460px;
        height:230px;
        padding: 20px;
        z-index: 9999;
        top: 25%;
        left: 60%;
    }
    #panel_applyalgo {
        position: absolute;
        background: #FFF;
        width:250px;
        height:400px;
        padding: 20px;
        z-index: 9999;
        top: 10%;
        left: 60%;
    }
    #panel_applyrecord {
        position: absolute;
        background: #FFF;
        width:330px;
        height:600px;
        padding: 20px;
        z-index: 9999;
        top: 10%;
        left: 60%;
    }

    .top-bar {
        width: 100%;
        height: 50px;
        margin: 0;
        display: flex;
    }
    .box-top {
        width: 100%;
        min-width: 1350px;
        background-color: rgba(255,255,255,0.5);
        padding: 20px;
        /*border-bottom-left-radius: 8px;*/
        /*border-bottom-right-radius: 8px;*/
    }
    .box-top-right{
    }
    .top-ui {
        width: 100%;
        min-width: 800px;
        height: 50px;
        list-style: none;
        margin: 0;
        padding: 0;
    }
    .top-ui li{
        width:10%;
        min-width: 50px;
        margin:-5px 50px 0 70px;
        float: left;
        text-align: center;
        display: block;
    }
    .top-ui a{
        color: black;
        text-decoration: none;//下划线;
    }
    .top-ui a:hover{
        color: white;
    }
    .top-ui img{
        height: 40px;
        margin: 0;
        padding: 0;
        display: inline;
        position: relative;
        top: -10px;
    }

    #marker {
        background-image: url('https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/marker_editor.png');
    }

    #polyline {
        background-image: url('https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/polyline.png');
    }

    #polygon {
        background-image: url('https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/polygon.png');
    }

    #circle {
        background-image: url('https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/circle.png');
    }

    #rectangle {
        background-image: url('https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/rectangle.png');
    }

    #ellipse {
        background-image: url('https://mapapi.qq.com/web/lbs/javascriptGL/demo/img/ellipse.png');
    }

    #info {
        position: absolute;
        left: 80%;
        right: 0;
        margin: auto;
        bottom: 30px;
        height: 250px;
        width: 400px;
        background-color: #fff;
        border-radius: 10px;
        font-size: 18px;
        line-height: 50px;
        text-align: left;
    }
</style>

<body onload="initMap()">
<div class="top-bar">
    <div class="box-top">
        <ul class="top-ui">
            <li STYLE="width: 600px">
                功能菜单：
                <a href="#" onclick="hide_all()">全部关闭</a> |
                <a href="#" onclick="changeBaseMap({type: 'satellite'})">卫星</a> |
                <a href="#" onclick="changeBaseMap({type: 'vector'})">矢量</a> |
                <a href="#" onclick="change3D()">3D</a> |
                <a href="#" onclick="show_tag()">点位搜索</a> |
                <a href="#" onclick="show_plan()">点位规划</a>
            </li>
            <li>
                <a href="#">&nbsp;</a>
            </li>
            <li>
                <a href="#">&nbsp;</a>
            </li>
            <li>
                <a href="#">&nbsp;</a>
            </li>
            <!--      <li>-->
            <!--        <a href="#">部门：吴兴区公安局</a> |-->
            <!--        <a href="#">用户：民警1</a>-->
            <!--      </li>-->
        </ul>
    </div>
</div>
<div id="container"></div>
<!--<div id="info"></div>-->
<div id="panel_tag" style="display: none">
    <div class="layui-col-md12">
        <div class="layui-card">
            <div class="layui-card-header">[标签管理]</div>
            <div class="layui-card-body">
                <div class="layui-btn-container layadmin-layer-demo">
                    <button data-type="test1" class="layui-btn layui-btn-primary" onclick="show_search()">全部</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">政府机构</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">城际交通</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">城市交通</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">城市道路</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">国省干道</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">桥梁隧道</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">新闻单位</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">金融机构</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">物流快递</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">能源通信</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">购物场所</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">生活服务</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">汽车服务</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">教育机构</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">医疗卫生</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">休闲娱乐</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">旅店业</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">特种企业</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">危险品相关单位</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">文化活动场所</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">建筑住宅</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">旅游景区</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">枪机</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">球机</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">无人机</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">车载</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">针孔</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">海康</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">大华</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">宇视</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">其他</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">视频分析(S01)</button>
                    <button data-type="test1" class="layui-btn layui-btn-primary">图片分析(S02)</button>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="panel_search" style="display: none">
    <div class="layui-card">
        <div class="layui-card-header">
<!--            <div id="toolControl">-->
<!--                <div class="toolItem active" id="marker" title="点标记"></div>-->
<!--                <div class="toolItem" id="polyline" title="折线"></div>-->
<!--                <div class="toolItem" id="rectangle" title="矩形"></div>-->
<!--                <button onclick="editor.enable();">启用</button>-->
<!--                <button onclick="editor.disable();">禁用</button>-->
<!--            </div>-->
        </div>
        <div class="layui-card-header">
            <div class="layui-col-lg10">
                <button id="" lay-submit="submit" onclick=""> 视频共享 </button> |
                <button id="" lay-submit="submit" onclick=""> 点位治理 </button>
            </div>
            <div class="layui-col-lg10">
                <label class="layui-form-label">监控点名称</label>
                <div class="layui-input-block">
                    <input type="text" id="pos_name" name="pos_name" placeholder="请输入" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-col-lg10">
                <label class="layui-form-label">项目名称</label>
                <div class="layui-input-block">
                    <input type="text" id="pos_name" name="pos_name" placeholder="请输入" autocomplete="off" class="layui-input">
                </div>
            </div>
            <div class="layui-col-lg2">
                <button id="pos_search" lay-submit="submit" onclick="pos_search()"> 搜 索 </button>
            </div>
        </div>
        <div class="layui-card-body">
            <div id="test-tree-demo1" style="display: block"></div>
            <div id="test-tree-demo2" style="display: none"></div>
            <div id="test-tree-demo3" style="display: none"></div>
            <div id="test-tree-demo4" style="display: none"></div>
        </div>
    </div>
</div>
<div id="panel_plan" style="display: none">
    <div class="layui-card">
        <div class="layui-card-header">
            <!--            <div id="toolControl">-->
            <!--                <div class="toolItem active" id="marker" title="点标记"></div>-->
            <!--                <div class="toolItem" id="polyline" title="折线"></div>-->
            <!--                <div class="toolItem" id="rectangle" title="矩形"></div>-->
            <!--                <button onclick="editor.enable();">启用</button>-->
            <!--                <button onclick="editor.disable();">禁用</button>-->
            <!--            </div>-->
        </div>
        <div class="layui-card-header">
            <div>
                <a href="#" onclick="changeywlx('demo1')">业务需求</a> | <a href="#" onclick="changeywlx('demo2')">规划点位</a> | <a href="#" onclick="changeywlx('demo3')">项目点位</a> | <a href="#" onclick="changeywlx('demo4')">待建点位</a>
            </div>
        </div>
    </div>
</div>

<div id="panel_menu" style="display: none">
    <div class="layui-row layui-col-space10 layui-form-item">
        <div class="layui-row layui-col-space10 layui-form-item">
            <div class="layui-col-lg6">
                <label class="layui-form-label">需求名称</label>
                <div class="layui-input-block">
                    <input id="menuName" type="text" name="menuName" lay-verify="required" placeholder="" autocomplete="off" class="layui-input" style="width: 350px">
                </div>
            </div>
        </div>
        <div class="layui-row layui-col-space10 layui-form-item">
            <div class="layui-col-lg12">
                <label class="layui-form-label">需求描述</label>
                <div class="layui-input-block">
                    <textarea id="menuContent" name="menuContent" placeholder="" class="layui-textarea"></textarea>
                </div>
            </div>
        </div>
        <div class="layui-input-block">
            <div class="layui-footer" style="left: 0;">
                <button id="menuSave" class="layui-btn" lay-submit="submit" lay-filter="component-form-demo1" onclick="menuSave()">保存</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <button id="menuCansol" class="layui-btn" lay-submit="submit" lay-filter="component-form-demo1" onclick="menuCansol()">取消</button>
            </div>
        </div>
    </div>
</div>
<div id="panel_share" style="display: none">
    <div class="layui-row layui-col-space10 layui-form-item">
        <div class="layui-row layui-col-space10 layui-form-item">
            <div class="layui-inline">
                <label class="layui-form-label">申请类别</label>
                <div class="layui-input-block">
                    <select id="projType" name="projType">
                        <option value="">全部</option>
                        <option value="点位并网">点位并网</option>
                        <option value="点位割接">点位割接</option>
                        <option value="点位迁改">点位迁改</option>
                        <option value="点位共享">点位共享</option>
                    </select>
                </div>
            </div>
        </div>
        <div class="layui-row layui-col-space10 layui-form-item">
            <div class="layui-col-lg12">
                <label class="layui-form-label">申请理由</label>
                <div class="layui-input-block">
                    <textarea id="shareContent" name="menuContent" placeholder="" class="layui-textarea"></textarea>
                </div>
            </div>
        </div>
        <div class="layui-input-block">
            <div class="layui-footer" style="left: 0;">
                <button id="shareSave" class="layui-btn" lay-submit="submit" lay-filter="component-form-demo1" onclick="shareSave()">保存</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                <button id="sareCansol" class="layui-btn" lay-submit="submit" lay-filter="component-form-demo1" onclick="shareSave()">取消</button>
            </div>
        </div>
    </div>
</div>
<div id="panel_applyalgo" style="display: none">
    <div class="layui-col-md12">
        <div class="layui-card">
            <div class="layui-card-body">
                <div id="test-tree-suanfa"></div>
            </div>
        </div>
    </div>
    <div class="layui-input-block">
        <div class="layui-footer" style="left: 0;">
            <button id="suanfaSave" class="layui-btn" lay-submit="submit" lay-filter="component-form-demo1" onclick="suanfaSave()">保存</button>
        </div>
    </div>
</div>
<div id="panel_applyrecord" style="display: none">
    <div class="layui-fluid">
        <div class="layui-card">
            <div class="layui-card-body">
                <div class="layui-tab">
                    <ul class="layui-tab-title">
                        <li class="layui-this">告警记录</li>
                        <li>操作记录</li>
                    </ul>
                    <div class="layui-tab-content">
                        <div class="layui-tab-item layui-show">
                            <!--            告警记录-->
                            <div class="layui-row layui-col-space12">
                                <div class="layui-card">
                                    <div class="layui-card-body">1、2022年6月26日发生告警：XXX，状态：未修复。</div>
                                    <div class="layui-card-body">2、2022年6月26日发生告警：XXXX，状态：未修复。</div>
                                    <div class="layui-card-body">3、2022年6月26日发生告警：XXXX，状态：已修复。</div>
                                </div>
                            </div>
                        </div>
                        <div class="layui-tab-item">
                            <!--            操作记录-->
                            <div class="layui-row layui-col-space12">
                                <div class="layui-card">
                                    <div class="layui-card-body">1、2022年6月26日申请点位割接：提交成功。</div>
                                    <div class="layui-card-body">2、2022年6月26日审批点位割接：审批通过。</div>
                                    <div class="layui-card-body">3、2022年6月26日实施点位割接：施工完成。</div>
                                    <div class="layui-card-body">4、2022年6月26日申请点位并网：提交成功。</div>
                                    <div class="layui-card-body">5、2022年6月26日审批点位并网：驳回申请。</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript">
    var map; // 地图
    var editor; // 编辑器
    var activeType = 'marker'; // 激活的图形编辑类型
    var center = new TMap.LatLng(30.857049,120.185889);


    // 切换激活图层
    document.getElementById('toolControl').addEventListener('click', (e) => {
        var id = e.target.id;
        if (id !== 'toolControl') {
            document.getElementById(activeType).className = 'toolItem';
            document.getElementById(id).className = 'toolItem active';
            activeType = id;

            editor.setActiveOverlay(id);
        }
    });


    function initMap() {
        // 初始化地图
        map = new TMap.Map('container', {
            center: new TMap.LatLng(30.857049,120.185889), // 设置地图中心点坐标
            zoom: 17, // 设置地图缩放级别
            pitch: 0, // 俯仰度
            rotation: 0, // 旋转角度
            baseMap: {
                type: "satellite",
                features: ["base", "building3d", "point"],
                buildingRange:[14.5, 25] //设置建筑物楼块的显示级别，目前设置成了所支持的最大范围[14.5, 25]
            },
        });

        var simplePath = [
            [new TMap.LatLng(30.858266,120.183306),
                new TMap.LatLng(30.858229,120.187361),
                new TMap.LatLng(30.856111,120.187061),
                new TMap.LatLng(30.856332,120.183091)],
            [new TMap.LatLng(30.857842,120.184336),
                new TMap.LatLng(30.857870,120.185827),
                new TMap.LatLng(30.856783,120.185881),
                new TMap.LatLng(30.856838,120.183939)],
            [new TMap.LatLng(30.856608,120.183156),
                new TMap.LatLng(30.856571,120.187619),
                new TMap.LatLng(30.854840,120.187190),
                new TMap.LatLng(30.853587,120.182555)]
        ];

        // 初始化几何图形及编辑器
        var marker = new TMap.MultiMarker({
            map: map,
            styles: {
                // 点标记样式
                marker: new TMap.MarkerStyle({
                    width: 20, // 样式宽
                    height: 30, // 样式高
                    anchor: { x: 10, y: 30 }, // 描点位置
                }),
            },
            geometries: [
                // 点标记数据数组
                {
                    // 标记位置(纬度，经度，高度)
                    position: center,
                    id: 'marker',
                },
            ],
        });
        var polyline = new TMap.MultiPolyline({
            map: map,
        });
        // var polygon = new TMap.MultiPolygon({
        //   map: map,
        // });
        // var circle = new TMap.MultiCircle({
        //   map: map,
        // });
        var rectangle = new TMap.MultiRectangle({
            map: map,
        });
        // var ellipse = new TMap.MultiEllipse({
        //   map: map,
        // });

        // 初始化几何图形及编辑器
        editor = new TMap.tools.GeometryEditor({
            // TMap.tools.GeometryEditor 文档地址：https://lbs.qq.com/webApi/javascriptGL/glDoc/glDocEditor
            map: map, // 编辑器绑定的地图对象
            overlayList: [
                // 可编辑图层 文档地址：https://lbs.qq.com/webApi/javascriptGL/glDoc/glDocEditor#4
                {
                    overlay: marker,
                    id: 'marker',
                },
                {
                    overlay: new TMap.MultiPolygon({
                        map,
                        styles: {
                            highlight: new TMap.PolygonStyle({
                                color: 'rgba(255, 255, 0, 0.6)'
                            })
                        },
                        geometries: [
                            {
                                paths: simplePath,
                            }
                        ]
                    }),
                    id: 'polygon',
                    selectedStyleId: 'highlight'
                },
                {
                    overlay: rectangle,
                    id: 'rectangle',
                },
            ],
            actionMode: TMap.tools.constants.EDITOR_ACTION.DRAW, // 编辑器的工作模式 INTERACT/DRAW
            activeOverlayId: 'marker', // 激活图层
            selectable: true, // 开启点选功能
            snappable: true, // 开启吸附
        });

        // 监听绘制结束事件，获取绘制几何图形
        editor.on('draw_complete', (geometry) => {
            // 判断当前处于编辑状态的图层id是否是overlayList中id为rectangle（矩形）图层
            if (editor.getActiveOverlay().id === 'rectangle') {
                // 获取矩形顶点坐标
                var id = geometry.id;
                var geo = rectangle.geometries.filter(function (item) {
                    return item.id === id;
                });
                console.log('绘制的矩形定位的坐标：', geo[0].paths);
            }
        });


        map.on('rightclick', function () {
            show_menu();
        });

        //初始化infoWindow
        var infoWindow = new TMap.InfoWindow({
            map: map,
            position: new TMap.LatLng(30.857049,120.185889),
            offset: { x: 0, y: -32 } //设置信息窗相对position偏移像素
        });
        infoWindow.close();//初始关闭信息窗关闭
        //监听标注点击事件
        marker.on("click", function (evt) {
            var pos=evt.geometry.position.toString();
            //设置infoWindow
            infoWindow.open(); //打开信息窗
            infoWindow.setPosition(evt.geometry.position);//设置信息窗位置
            infoWindow.setContent(
                '<div align="left" class="content">'+'<p>点位名称：吴兴区人民政府</p>'+'<p>监控点编码：330501000000</p>'+'<p>所属部门：区公安分局</p>'+'<p>'+'经度：'+pos.substring(0,pos.indexOf(','))+'</p>'+'<p>纬度：'+pos.substring(pos.indexOf(',')+1,pos.length)+'<p>标签分类：政府机构</p>'+'<p>算法能力：- -</p>'+'</p>操作：<a href="#" onclick="videoplay()">视频</a> | <a href="#" onclick="share()">申请</a> | <a href="#" onclick="applyalgo()">算法</a> | <a href="#" onclick="applyrecord()">记录</a>'+'</div>'
            );//设置信息窗内容
        })

        //搜索功能还不行！
        function searchByKeyword() {
            infoWindowList.forEach((infoWindow) => {
                infoWindow.close();
            });
            infoWindowList.length = 0;
            markers.setGeometries([]);
            // 在地图显示范围内以给定的关键字搜索地点
            search
                .searchRectangle({
                    keyword: document.getElementById('keyword').value,
                    bounds: map.getBounds(),
                })
                .then((result) => {
                    result.data.forEach((item, index) => {
                        var geometries = markers.getGeometries();
                        var infoWindow = new TMap.InfoWindow({
                            map: map,
                            position: item.location,
                            content: `<h3>${item.title}</h3><p>地址：${item.address}</p><p>电话：${item.tel}</p>`,
                            offset: { x: 0, y: -50 },
                        }); // 新增信息窗体显示地标的名称与地址、电话等信息
                        infoWindow.close();
                        infoWindowList[index] = infoWindow;
                        geometries.push({
                            id: String(index), // 点标注数据数组
                            position: item.location,
                        });
                        markers.updateGeometries(geometries); // 绘制地点标注
                        markers.on('click', (e) => {
                            infoWindowList[Number(e.geometry.id)].open();
                        }); // 点击标注显示信息窗体
                    });
                });
        }

        // 计算路径的实际距离
        var infoDom = document.getElementById('info');
        infoDom.innerText = '(1)共接入1473路监控，在线率90%;\n(2)每平方公里监控XX路，密度XX%;\n(3)共有杆件资源XX根；\n(4)共涉及项目XX个；\n(5)共有算力100，当前已使用80。';
    }

    // 动态设置底图类型
    function changeBaseMap(baseMap) {
        map.setBaseMap(baseMap);
    }

    function show_tag(){
        document.getElementById("panel_tag").style.display="block";
        document.getElementById("panel_search").style.display="none";
        document.getElementById("panel_plan").style.display="none";
        document.getElementById("panel_share").style.display="none";
        document.getElementById("panel_manage").style.display="none";
    }
    function show_search(){
        document.getElementById("panel_tag").style.display="none";
        document.getElementById("panel_search").style.display="block";
        document.getElementById("panel_plan").style.display="none";
        document.getElementById("panel_share").style.display="none";
        document.getElementById("panel_manage").style.display="none";
    }
    function show_plan(){
        document.getElementById("panel_tag").style.display="none";
        document.getElementById("panel_search").style.display="none";
        document.getElementById("panel_plan").style.display="block";
        document.getElementById("panel_share").style.display="none";
        document.getElementById("panel_manage").style.display="none";
    }
    function change3D(){
        map.setViewMode('3D');
        map.setPitch(70);
    }
    function hide_all(){
        map.setViewMode('2D');
        document.getElementById("panel_tag").style.display="none";
        document.getElementById("panel_plan").style.display="none";
        document.getElementById("panel_menu").style.display="none";
        document.getElementById("panel_applyalgo").style.display="none";
        document.getElementById("panel_applyrecord").style.display="none";
        document.getElementById("panel_share").style.display="none";
    }

    function changeywlx(ywlx){
        if(ywlx=='demo2'){
            document.getElementById("test-tree-demo1").style.display="none";
            document.getElementById("test-tree-demo2").style.display="block";
            document.getElementById("test-tree-demo3").style.display="none";
            document.getElementById("test-tree-demo4").style.display="none";
            document.getElementById("toolControl").style.display="block";
        }else if(ywlx=='demo3'){
            document.getElementById("test-tree-demo1").style.display="none";
            document.getElementById("test-tree-demo2").style.display="none";
            document.getElementById("test-tree-demo3").style.display="block";
            document.getElementById("test-tree-demo4").style.display="none";
            document.getElementById("toolControl").style.display="none";
        }else if(ywlx=='demo4'){
            document.getElementById("test-tree-demo1").style.display="none";
            document.getElementById("test-tree-demo2").style.display="none";
            document.getElementById("test-tree-demo3").style.display="none";
            document.getElementById("test-tree-demo4").style.display="block";
            document.getElementById("toolControl").style.display="none";
        }else{
            document.getElementById("test-tree-demo1").style.display="block";
            document.getElementById("test-tree-demo2").style.display="none";
            document.getElementById("test-tree-demo3").style.display="none";
            document.getElementById("test-tree-demo4").style.display="none";
            document.getElementById("toolControl").style.display="block";
        }
    }
    function show_menu(){
        document.getElementById("panel_menu").style.display="block";
    }
    function menuSave(){
        document.getElementById("panel_menu").style.display="none";
    }
    function menuCansol(){
        document.getElementById("menuName").value="";
        document.getElementById("menuContent").value="";
        document.getElementById("panel_menu").style.display="none";
    }

    function videoplay(){
        window.open ('../../cockpit/video/video.html', 'newwindow', 'height=230, width=390, top=50%, left=50%, toolbar=no, menubar=no, scrollbars=no, resizable=no,location=n o, status=no')
    }
    function applyalgo(){
        document.getElementById("panel_applyalgo").style.display="block";
        document.getElementById("panel_applyrecord").style.display="none";
        document.getElementById("panel_share").style.display="none";
    }
    function applyrecord(){
        document.getElementById("panel_applyrecord").style.display="block";
        document.getElementById("panel_applyalgo").style.display="none";
        document.getElementById("panel_share").style.display="none";
    }
    function suanfaSave(){
        document.getElementById("panel_applyalgo").style.display="none";
    }
    function share(){
        document.getElementById("panel_share").style.display="block";
        document.getElementById("panel_applyalgo").style.display="none";
        document.getElementById("panel_applyrecord").style.display="none";
    }
    function shareSave(){
        document.getElementById("panel_share").style.display="none";
    }
</script>
<script src="http://apps.bdimg.com/libs/jquery/2.0.0/jquery.min.js"></script>
<script src="http://apps.bdimg.com/libs/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script src="${pageContext.request.contextPath}/resources/script/login.js"></script>
<script src="../js/demo.js"></script>
<script src="../../layuiadmin/layui/layui.js"></script>
<script>
    layui.config({
        base: '../../layuiadmin/' //静态资源所在路径
    }).extend({
        index: 'lib/index' //主入口模块
    }).use(['index', 'tree' , 'form' , 'util' ,'table', 'laydate'], function(){
        var admin = layui.admin
            ,table = layui.table
            ,$ = layui.$
            ,element = layui.element
            ,laydate = layui.laydate
            ,tree = layui.tree
            ,util = layui.util
            ,form = layui.form

            //模拟数据
            ,data1 = [{
                title: '业务需求1'
                ,id: 1
                ,field: 'noti0'
                ,spread: true
                ,children: [{
                    title: '需求01'
                    ,id: 2
                    ,field: 'noti2'
                },{
                    title: '需求02'
                    ,id: 3
                    ,field: 'noti3'
                },{
                    title: '需求03'
                    ,id: 4
                    ,field: 'noti4'
                }]
            }]

            ,data2 = [{
                title: '规划点位1'
                ,id: 1
                ,field: 'noti0'
                ,spread: true
                ,children: [{
                    title: '点位01'
                    ,id: 2
                    ,field: 'noti2'
                },{
                    title: '点位02'
                    ,id: 3
                    ,field: 'noti3'
                },{
                    title: '点位03'
                    ,id: 4
                    ,field: 'noti4'
                }]
            }]

            ,data3 = [{
                title: '项目点位1'
                ,id: 1
                ,field: 'noti0'
                ,spread: true
                ,children: [{
                    title: '规划01'
                    ,id: 2
                    ,field: 'noti2'
                    ,children: [{
                        title: '点位01'
                        ,id: 2
                        ,field: 'noti2'
                    },{
                        title: '点位02'
                        ,id: 2
                        ,field: 'noti2'
                    },]
                },{
                    title: '规划02'
                    ,id: 3
                    ,field: 'noti3'
                },{
                    title: '规划03'
                    ,id: 4
                    ,field: 'noti4'
                }]
            }]

            ,data4 = [{
                title: '待建点位1'
                ,id: 1
                ,field: 'noti0'
                ,spread: true
                ,children: [{
                    title: '待建01'
                    ,id: 2
                    ,field: 'noti2'
                },{
                    title: '待建02'
                    ,id: 3
                    ,field: 'noti3'
                },{
                    title: '待建03'
                    ,id: 4
                    ,field: 'noti4'
                }]
            }]

            //模拟数据
            ,data5 = [{
                title: '已建点位'
                ,id: 1
                ,field: 'noti0'
                ,spread: true
                ,children: [{
                    title: '点位1'
                    ,id: 2
                    ,field: 'noti2'
                },{
                    title: '点位2'
                    ,id: 3
                    ,field: 'noti3'
                },{
                    title: '点位3'
                    ,id: 4
                    ,field: 'noti4'
                }]
            }]

            //模拟数据
            ,suanfa = [{
                title: '算法类别'
                ,id: 1
                ,field: 'noti0'
                ,spread: true
                ,children: [{
                    title: '人脸识别'
                    ,id: 2
                    ,field: 'noti2'
                },{
                    title: '人像比对'
                    ,id: 2
                    ,field: 'noti2'
                },{
                    title: '车牌识别'
                    ,id: 3
                    ,field: 'noti3'
                },{
                    title: '占道经营'
                    ,id: 4
                    ,field: 'noti4'
                },{
                    title: '扬尘监测'
                    ,id: 4
                    ,field: 'noti4'
                },{
                    title: '水质监测'
                    ,id: 4
                    ,field: 'noti4'
                },{
                    title: '垃圾分类监测'
                    ,id: 4
                    ,field: 'noti4'
                },{
                    title: '城市道路积水'
                    ,id: 4
                    ,field: 'noti4'
                },{
                    title: '非机动车逆行'
                    ,id: 4
                    ,field: 'noti4'
                },{
                    title: '消防通道堵塞'
                    ,id: 4
                    ,field: 'noti4'
                },{
                    title: '明火烟雾识别'
                    ,id: 4
                    ,field: 'noti4'
                },{
                    title: '电梯内电瓶车识别'
                    ,id: 4
                    ,field: 'noti4'
                }]
            }]

        //头工具栏事件
        table.on('toolbar(test-table-toolbar)', function(obj){
            var checkStatus = table.checkStatus(obj.config.id);
            switch(obj.event){
                case 'add':
                    layer.open({
                        type: 2
                        ,title: '文件新增'
                        ,content: 'docdet.html?add'
                        ,maxmin: true
                        ,area: ['1200px', '600px']
                    });
                    break;
            };
        });


        //仅节点左侧图标控制收缩
        tree.render({
            elem: '#test-tree-demo1'
            ,data: data1
            ,onlyIconControl: true  //是否仅允许节点左侧图标控制展开收缩
            ,click: function(obj){
                $('#typeId').val(obj.data1.field);
                $('#typeName').val(obj.data1.title);
                table.reload('docReload', {
                    page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    ,where: {
                        typeId: obj.data.field
                    }
                }, 'data1');
            }
        });

        tree.render({
            elem: '#test-tree-demo2'
            ,data: data2
            ,onlyIconControl: true  //是否仅允许节点左侧图标控制展开收缩
            ,click: function(obj){
                $('#typeId').val(obj.data2.field);
                $('#typeName').val(obj.data2.title);
                table.reload('docReload', {
                    page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    ,where: {
                        typeId: obj.data.field
                    }
                }, 'data2');
            }
        });

        tree.render({
            elem: '#test-tree-demo3'
            ,data: data3
            ,onlyIconControl: true  //是否仅允许节点左侧图标控制展开收缩
            ,click: function(obj){
                $('#typeId').val(obj.data3.field);
                $('#typeName').val(obj.data3.title);
                table.reload('docReload', {
                    page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    ,where: {
                        typeId: obj.data.field
                    }
                }, 'data3');
            }
        });

        tree.render({
            elem: '#test-tree-demo4'
            ,data: data4
            ,onlyIconControl: true  //是否仅允许节点左侧图标控制展开收缩
            ,click: function(obj){
                $('#typeId').val(obj.data4.field);
                $('#typeName').val(obj.data4.title);
                table.reload('docReload', {
                    page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    ,where: {
                        typeId: obj.data.field
                    }
                }, 'data4');
            }
        });

        tree.render({
            elem: '#test-tree-demo5'
            ,data: data5
            ,onlyIconControl: true  //是否仅允许节点左侧图标控制展开收缩
            ,click: function(obj){
                $('#typeId').val(obj.data5.field);
                $('#typeName').val(obj.data5.title);
                table.reload('docReload', {
                    page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    ,where: {
                        typeId: obj.data.field
                    }
                }, 'data5');
            }
        });

        tree.render({
            elem: '#test-tree-suanfa'
            ,data: suanfa
            ,onlyIconControl: true  //是否仅允许节点左侧图标控制展开收缩
            ,showCheckbox: true
            ,click: function(obj){
                $('#typeId').val(obj.data4.field);
                $('#typeName').val(obj.data4.title);
                table.reload('docReload', {
                    page: {
                        curr: 1 //重新从第 1 页开始
                    }
                    ,where: {
                        typeId: obj.data.field
                    }
                }, 'suanfa');
            }
        });

        $('.layui-fluid .layui-btn').on('click', function(){
            var type = $(this).data('type');
            active[type] ? active[type].call(this) : '';
        });
    })
</script>
</body>
</html>